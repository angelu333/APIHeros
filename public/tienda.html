<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tienda | HeroPet Legends</title>
  <link rel="stylesheet" href="styles.css">
  <script src="init-game.js"></script>
  <style>
    .tienda-container {
      min-height: 100vh;
      background: linear-gradient(135deg, #23243a 0%, #1e2a78 100%);
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .nav-bar {
      width: 100%;
      background: #1a2340;
      box-shadow: 0 2px 16px #0004;
      display: flex;
      justify-content: center;
      gap: 2rem;
      padding: 1.2rem 0;
      margin-bottom: 2rem;
      border-radius: 18px;
    }
    
    .nav-btn {
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      color: #fff;
      border: none;
      border-radius: 18px;
      font-size: 1.2rem;
      font-weight: bold;
      padding: 0.7rem 2.2rem;
      cursor: pointer;
      box-shadow: 0 2px 8px #0002;
      transition: all 0.3s ease;
    }
    
    .nav-btn:hover {
      background: linear-gradient(135deg, #0072ff, #00c6ff);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px #0004;
    }
    
    .monedas-display {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #ffd700, #ffb300);
      color: #1a2340;
      padding: 0.8rem 1.5rem;
      border-radius: 25px;
      font-weight: bold;
      font-size: 1.1rem;
      box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
      z-index: 1000;
      max-width: 200px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .inventario-display {
      position: fixed;
      top: 20px;
      left: 20px;
      background: linear-gradient(135deg, #4caf50, #45a049);
      color: #fff;
      padding: 0.8rem 1.5rem;
      border-radius: 25px;
      font-weight: bold;
      font-size: 1.1rem;
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
      z-index: 1000;
    }
    
    .titulo-seccion {
      color: #00c6ff;
      font-size: 2.5rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 1rem;
      text-shadow: 0 2px 8px #0008;
    }
    
    .subtitulo {
      color: #fff;
      text-align: center;
      font-size: 1.2rem;
      margin-bottom: 2rem;
      opacity: 0.8;
    }
    
    .comida-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      max-width: 1200px;
      width: 100%;
      margin-top: 2rem;
    }
    
    .comida-card {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid #00c6ff;
      border-radius: 20px;
      padding: 2rem;
      text-align: center;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    .comida-card:hover {
      background: rgba(0, 198, 255, 0.2);
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 198, 255, 0.3);
    }
    
    .comida-emoji {
      font-size: 4rem;
      margin-bottom: 1rem;
    }
    
    .comida-nombre {
      font-size: 1.5rem;
      color: #00c6ff;
      font-weight: bold;
      margin-bottom: 1rem;
    }
    
    .comida-precio {
      background: linear-gradient(135deg, #ffd700, #ffb300);
      color: #1a2340;
      padding: 0.5rem 1rem;
      border-radius: 15px;
      font-weight: bold;
      display: inline-block;
      margin-bottom: 1rem;
    }
    
    .comida-efectos {
      color: #fff;
      margin-bottom: 1.5rem;
      line-height: 1.5;
    }
    
    .comida-cantidad {
      color: #4caf50;
      font-weight: bold;
      margin-bottom: 1rem;
    }
    
    .comprar-btn {
      background: linear-gradient(135deg, #4caf50, #45a049);
      color: #fff;
      border: none;
      border-radius: 15px;
      padding: 0.8rem 2rem;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }
    
    .comprar-btn:hover {
      background: linear-gradient(135deg, #45a049, #4caf50);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
    }
    
    .comprar-btn:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .feedback-mensaje {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.9);
      color: #fff;
      padding: 1rem 2rem;
      border-radius: 12px;
      font-size: 1.2rem;
      font-weight: bold;
      z-index: 1000;
      animation: feedbackIn 0.5s ease-out;
    }
    
    @keyframes feedbackIn {
      0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
      100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }

    .cantidad-destacada {
      font-weight: bold;
      color: #4caf50;
      font-size: 1.1em;
    }
    
    .modal {
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7);
    }
    
    .modal-content {
      background: linear-gradient(135deg, #1a2340, #23243a);
      margin: 5% auto;
      padding: 0;
      border-radius: 20px;
      width: 80%;
      max-width: 600px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.5);
    }
    
    .modal-header {
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      color: white;
      padding: 1.5rem;
      border-radius: 20px 20px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .modal-header h2 {
      margin: 0;
      font-size: 1.5rem;
    }
    
    .close {
      color: white;
      font-size: 2rem;
      font-weight: bold;
      cursor: pointer;
      transition: opacity 0.3s;
    }
    
    .close:hover {
      opacity: 0.7;
    }
    
    .modal-body {
      padding: 2rem;
      max-height: 400px;
      overflow-y: auto;
    }
    
    .inventario-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      margin: 0.5rem 0;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      border-left: 4px solid #4caf50;
    }
    
    .inventario-item-vacio {
      text-align: center;
      padding: 2rem;
      color: #888;
      font-style: italic;
    }
    
    .item-info {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .item-emoji {
      font-size: 2rem;
    }
    
    .item-details h4 {
      margin: 0 0 0.5rem 0;
      color: #00c6ff;
    }
    
    .item-details p {
      margin: 0;
      color: #ccc;
      font-size: 0.9rem;
    }
    
    .item-cantidad {
      background: #4caf50;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-weight: bold;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
  <div class="tienda-container">
    <!-- Barra de navegaci√≥n -->
    <nav class="nav-bar">
      <button class="nav-btn" onclick="window.location.href='home.html'">üè† Inicio</button>
      <button class="nav-btn" onclick="window.location.href='tienda.html'" style="background: linear-gradient(135deg, #ffd700, #ffb300); color: #1a2340;">üõí Tienda</button>
      <button class="nav-btn" onclick="window.location.href='minijuegos.html'">üéÆ Minijuegos</button>
      <button class="nav-btn" onclick="logout()" style="background: #ff5252;">üö™ Salir</button>
    </nav>
    
    <!-- Display de monedas -->
    <div class="monedas-display" id="monedasDisplay">
      ü™ô <span id="monedasCantidad">0</span> Monedas
    </div>
    
    <!-- Display de inventario -->
    <div class="inventario-display" id="inventarioDisplay" onclick="mostrarInventarioCompleto()" style="cursor: pointer;">
      üì¶ Inventario: <span id="inventarioCantidad">0</span> items
    </div>
    
    <!-- T√≠tulo -->
    <h1 class="titulo-seccion">üõí Tienda de Comida</h1>
    <p class="subtitulo">¬°Compra comida deliciosa para tu mascota con las monedas que ganaste!</p>
    
    <!-- Grid de comidas -->
    <div class="comida-grid">
      <!-- Manzana -->
      <div class="comida-card">
        <div class="comida-emoji">üçé</div>
        <h3 class="comida-nombre">Manzana</h3>
        <div class="comida-precio">ü™ô 5 Monedas</div>
        <p class="comida-efectos">
          +15 Hambre<br>
          Comida saludable y nutritiva
        </p>
        <div class="comida-cantidad">En inventario: <span id="manzana-cantidad" class="cantidad-destacada">0</span></div>
        <button class="comprar-btn" onclick="comprarComida('manzana', 5)">Comprar</button>
      </div>
      
      <!-- Galleta -->
      <div class="comida-card">
        <div class="comida-emoji">üç™</div>
        <h3 class="comida-nombre">Galleta</h3>
        <div class="comida-precio">ü™ô 10 Monedas</div>
        <p class="comida-efectos">
          +10 Hambre<br>
          +5 Felicidad<br>
          ¬°Deliciosa galleta casera!
        </p>
        <div class="comida-cantidad">En inventario: <span id="galleta-cantidad" class="cantidad-destacada">0</span></div>
        <button class="comprar-btn" onclick="comprarComida('galleta', 10)">Comprar</button>
      </div>
      
      <!-- Pizza -->
      <div class="comida-card">
        <div class="comida-emoji">üçï</div>
        <h3 class="comida-nombre">Pizza</h3>
        <div class="comida-precio">ü™ô 25 Monedas</div>
        <p class="comida-efectos">
          +50 Hambre<br>
          +20 Felicidad<br>
          ¬°Pizza italiana aut√©ntica!
        </p>
        <div class="comida-cantidad">En inventario: <span id="pizza-cantidad" class="cantidad-destacada">0</span></div>
        <button class="comprar-btn" onclick="comprarComida('pizza', 25)">Comprar</button>
      </div>
      
      <!-- Pastel -->
      <div class="comida-card">
        <div class="comida-emoji">üéÇ</div>
        <h3 class="comida-nombre">Pastel</h3>
        <div class="comida-precio">ü™ô 30 Monedas</div>
        <p class="comida-efectos">
          +40 Hambre<br>
          +30 Felicidad<br>
          ¬°Pastel de cumplea√±os especial!
        </p>
        <div class="comida-cantidad">En inventario: <span id="pastel-cantidad" class="cantidad-destacada">0</span></div>
        <button class="comprar-btn" onclick="comprarComida('pastel', 30)">Comprar</button>
      </div>
      
      <!-- Zanahoria -->
      <div class="comida-card">
        <div class="comida-emoji">ü•ï</div>
        <h3 class="comida-nombre">Zanahoria</h3>
        <div class="comida-precio">ü™ô 8 Monedas</div>
        <p class="comida-efectos">
          +12 Hambre<br>
          +8 Salud<br>
          ¬°Vegetal nutritivo y saludable!
        </p>
        <div class="comida-cantidad">En inventario: <span id="zanahoria-cantidad" class="cantidad-destacada">0</span></div>
        <button class="comprar-btn" onclick="comprarComida('zanahoria', 8)">Comprar</button>
      </div>
      
      <!-- Carne Premium -->
      <div class="comida-card">
        <div class="comida-emoji">ü•©</div>
        <h3 class="comida-nombre">Carne Premium</h3>
        <div class="comida-precio">ü™ô 50 Monedas</div>
        <p class="comida-efectos">
          +30 Hambre<br>
          +40 Felicidad<br>
          +20 Salud<br>
          ¬°Carne de la m√°s alta calidad!
        </p>
        <div class="comida-cantidad">En inventario: <span id="carne-cantidad" class="cantidad-destacada">0</span></div>
        <button class="comprar-btn" onclick="comprarComida('carne', 50)">Comprar</button>
      </div>
    </div>

    <!-- Modal de Inventario Completo -->
    <div id="inventarioModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>üì¶ Inventario Completo</h2>
          <span class="close" onclick="cerrarInventario()">&times;</span>
        </div>
        <div class="modal-body">
          <div id="inventarioLista"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Verificar autenticaci√≥n
    const token = localStorage.getItem('gameToken');
    if (!token) {
      window.location.href = 'index.html';
    }
    
    // Cargar datos
    function cargarDatos() {
      const monedas = localStorage.getItem('monedas') || 0;
      document.getElementById('monedasCantidad').textContent = monedas;
      
      // Cargar inventario
      const inventario = JSON.parse(localStorage.getItem('inventario') || '{}');
      const totalItems = Object.values(inventario).reduce((sum, cantidad) => sum + cantidad, 0);
      document.getElementById('inventarioCantidad').textContent = totalItems;
      
      // Actualizar cantidades de cada comida
      document.getElementById('manzana-cantidad').textContent = inventario.manzana || 0;
      document.getElementById('galleta-cantidad').textContent = inventario.galleta || 0;
      document.getElementById('pizza-cantidad').textContent = inventario.pizza || 0;
      document.getElementById('pastel-cantidad').textContent = inventario.pastel || 0;
      document.getElementById('zanahoria-cantidad').textContent = inventario.zanahoria || 0;
      document.getElementById('carne-cantidad').textContent = inventario.carne || 0;
    }
    
    // Funci√≥n para comprar comida
    function comprarComida(tipo, precio) {
      const monedas = parseInt(localStorage.getItem('monedas') || 0);
      
      if (monedas < precio) {
        mostrarFeedback('‚ùå No tienes suficientes monedas');
        return;
      }
      
      // Descontar monedas
      const nuevasMonedas = monedas - precio;
      localStorage.setItem('monedas', nuevasMonedas);
      
      // Agregar al inventario
      const inventario = JSON.parse(localStorage.getItem('inventario') || '{}');
      inventario[tipo] = (inventario[tipo] || 0) + 1;
      localStorage.setItem('inventario', JSON.stringify(inventario));
      
      // Actualizar display
      cargarDatos();
      
      // Mostrar feedback
      const nombresComida = {
        'manzana': 'üçé Manzana',
        'galleta': 'üç™ Galleta',
        'pizza': 'üçï Pizza',
        'pastel': 'üéÇ Pastel',
        'zanahoria': 'ü•ï Zanahoria',
        'carne': 'ü•© Carne Premium'
      };
      
      mostrarFeedback(`‚úÖ ¬°${nombresComida[tipo]} comprada!`);
    }
    
    // Funci√≥n para mostrar feedback
    function mostrarFeedback(mensaje) {
      // Remover feedback anterior si existe
      const feedbackAnterior = document.querySelector('.feedback-mensaje');
      if (feedbackAnterior) {
        feedbackAnterior.remove();
      }
      
      // Crear nuevo feedback
      const feedback = document.createElement('div');
      feedback.className = 'feedback-mensaje';
      feedback.textContent = mensaje;
      document.body.appendChild(feedback);
      
      // Remover despu√©s de 2 segundos
      setTimeout(() => {
        feedback.remove();
      }, 2000);
    }
    
    // Funci√≥n de logout
    function logout() {
      localStorage.clear();
      window.location.href = 'index.html';
    }

    // Funci√≥n para mostrar el inventario completo en un modal
    function mostrarInventarioCompleto() {
      const inventario = JSON.parse(localStorage.getItem('inventario') || '{}');
      const inventarioLista = document.getElementById('inventarioLista');
      inventarioLista.innerHTML = ''; // Limpiar contenido anterior

      if (Object.keys(inventario).length === 0) {
        inventarioLista.innerHTML = '<div class="inventario-item-vacio">Tu inventario est√° vac√≠o.</div>';
      } else {
        for (const comida in inventario) {
          const cantidad = inventario[comida];
          const item = document.createElement('div');
          item.className = 'inventario-item';
          item.innerHTML = `
            <div class="item-info">
              <div class="item-emoji">${getEmojiForComida(comida)}</div>
              <div class="item-details">
                <h4>${getNombreComida(comida)}</h4>
                <p>Cantidad: ${cantidad}</p>
              </div>
            </div>
            <div class="item-cantidad">${cantidad}</div>
          `;
          inventarioLista.appendChild(item);
        }
      }
      document.getElementById('inventarioModal').style.display = 'block';
    }

    // Funci√≥n para cerrar el modal de inventario
    function cerrarInventario() {
      document.getElementById('inventarioModal').style.display = 'none';
    }

    // Helper functions for emojis and names
    function getEmojiForComida(tipo) {
      switch (tipo) {
        case 'manzana': return 'üçé';
        case 'galleta': return 'üç™';
        case 'pizza': return 'üçï';
        case 'pastel': return 'üéÇ';
        case 'zanahoria': return 'ü•ï';
        case 'carne': return 'ü•©';
        default: return 'üì¶'; // Default for unknown
      }
    }

    function getNombreComida(tipo) {
      switch (tipo) {
        case 'manzana': return 'Manzana';
        case 'galleta': return 'Galleta';
        case 'pizza': return 'Pizza';
        case 'pastel': return 'Pastel';
        case 'zanahoria': return 'Zanahoria';
        case 'carne': return 'Carne Premium';
        default: return tipo; // Default for unknown
      }
    }
    
    // Cargar datos al iniciar
    cargarDatos();
  </script>
</body>
</html> 